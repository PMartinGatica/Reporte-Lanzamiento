<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chart Labels</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
</head>
<body class="bg-gray-900 text-white p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8 text-center">üß™ Test de Etiquetas en Gr√°ficos</h1>
        
        <div class="bg-gray-800 p-6 rounded-lg">
            <h2 class="text-xl font-bold mb-4">Gr√°fico de Prueba con Etiquetas</h2>
            <div class="relative h-96">
                <canvas id="testChart"></canvas>
            </div>
        </div>
        
        <div class="mt-6 bg-gray-800 p-4 rounded-lg">
            <h3 class="font-bold mb-2">Estado de las librer√≠as:</h3>
            <div id="libraryStatus"></div>
        </div>
    </div>

    <script>
        // Verificar librer√≠as
        const statusDiv = document.getElementById('libraryStatus');
        let status = '';
        
        if (typeof Chart !== 'undefined') {
            status += '‚úÖ Chart.js cargado<br>';
        } else {
            status += '‚ùå Chart.js no encontrado<br>';
        }
        
        if (typeof ChartDataLabels !== 'undefined') {
            status += '‚úÖ ChartDataLabels cargado<br>';
        } else {
            status += '‚ùå ChartDataLabels no encontrado<br>';
        }
        
        // Registrar plugin
        if (typeof Chart !== 'undefined' && typeof ChartDataLabels !== 'undefined') {
            try {
                Chart.register(ChartDataLabels);
                status += '‚úÖ ChartDataLabels registrado correctamente<br>';
            } catch (error) {
                status += '‚ùå Error al registrar ChartDataLabels: ' + error.message + '<br>';
            }
        }
        
        statusDiv.innerHTML = status;
        
        // Crear gr√°fico de prueba
        const ctx = document.getElementById('testChart').getContext('2d');
        
        const testChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['D√≠a 1', 'D√≠a 2', 'D√≠a 3', 'D√≠a 4', 'D√≠a 5'],
                datasets: [{
                    type: 'bar',
                    label: 'Prime Handle',
                    data: [120, 150, 100, 180, 160],
                    backgroundColor: 'rgba(59, 130, 246, 0.6)',
                    borderColor: 'rgba(59, 130, 246, 1)',
                    borderWidth: 2,
                    yAxisID: 'y',
                    datalabels: {
                        anchor: 'center',
                        align: 'center',
                        color: 'white',
                        font: { weight: 'bold', size: 14 },
                        formatter: (value) => value.toString()
                    }
                }, {
                    type: 'line',
                    label: 'FTY%',
                    data: [95.2, 96.8, 94.5, 97.1, 95.9],
                    borderColor: '#f87171',
                    backgroundColor: '#f87171',
                    tension: 0.4,
                    pointRadius: 6,
                    pointBackgroundColor: '#f87171',
                    yAxisID: 'y1',
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        offset: 10,
                        color: 'white',
                        font: { weight: 'bold', size: 12 },
                        formatter: (value) => value.toFixed(1) + '%',
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        borderRadius: 4,
                        padding: 4
                    }
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: { display: true, text: 'Prime Handle', color: 'white' },
                        ticks: { color: 'white' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        min: 90,
                        max: 100,
                        title: { display: true, text: 'FTY%', color: 'white' },
                        ticks: { 
                            color: 'white',
                            callback: v => v + '%'
                        },
                        grid: { drawOnChartArea: false }
                    },
                    x: {
                        ticks: { color: 'white' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    }
                },
                plugins: {
                    legend: { labels: { color: 'white' } },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: 'white',
                        bodyColor: 'white'
                    }
                }
            }
        });
        
        console.log('üß™ Gr√°fico de prueba creado:', testChart);
    </script>
</body>
</html>
